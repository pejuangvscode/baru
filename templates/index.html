<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Face Naming</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .image-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px; }
        .image-item { position: relative; }
        .image-item img { width: 100%; height: auto; }
        .checkbox { position: absolute; top: 5px; left: 5px; }
        .form { margin-top: 20px; }
    </style>
</head>
<body>
    <h1>Namai Wajah Unknown</h1>
    <div class="image-grid">
        {% for file in unknown_files %}
        <div class="image-item">
            <img src="/static/unknown/{{ file }}" alt="{{ file }}">
            <input type="checkbox" class="checkbox" value="{{ file }}">
        </div>
        {% endfor %}
    </div>
    <div class="form">
        <input type="text" id="name" placeholder="Nama">
        <button onclick="assign()">Assign</button>
    </div>
    <script>
        let lastSelectedIndex = -1;

        function assign() {
            const name = document.getElementById('name').value;
            if (!name) return alert('Masukkan nama');
            const selected = Array.from(document.querySelectorAll('.checkbox:checked')).map(cb => cb.value);
            if (selected.length === 0) return alert('Pilih gambar');
            fetch('/assign', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ name, files: selected })
            }).then(res => res.json()).then(data => {
                alert(data.message);
                location.reload();
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            const checkboxes = document.querySelectorAll('.checkbox');
            checkboxes.forEach((checkbox, index) => {
                checkbox.addEventListener('click', (e) => {
                    if (e.shiftKey && lastSelectedIndex !== -1) {
                        const start = Math.min(lastSelectedIndex, index);
                        const end = Math.max(lastSelectedIndex, index);
                        for (let i = start; i <= end; i++) {
                            checkboxes[i].checked = !checkboxes[i].checked;
                        }
                    } else {
                        lastSelectedIndex = index;
                    }
                });
            });
        });
    </script>
</body>
</html>